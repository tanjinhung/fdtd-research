# Note: The dependence on the header files is generated by
#       makedepend.  Prior to making, issue the command:
#
#               make depend
#
##########################################################
MAINSRC=lossy-half.c
SRC=${MAINSRC} abc.c ezincharm.c gridinitloss.c snapshot.c tfsf.c update3.c
OFILES=${SRC:.c=.o}
EXE=${MAINSRC:.c=}

all: ${EXE}

${EXE}: ${OFILES}
	gcc ${OFILES} -lm -o $@

# A way to obtain unique file names -- not truly necessary, but
# prevents some duplication in the depends.  Found the perl script on
# the Web.  No way I would generate this on my own.  Note that the
# double dollar signs are reduced to single dollar signs before perl
# sees the script.
UNIQSRC=$(shell echo ${SRC} |\
       perl -e 'while(<>) {               \
          %s=();                          \
          @u=grep {! $$s{$$_} ++ } sort(split()); \
          print "@u";}')

#================================================

.SUFFIXES: .c .o

.c.o:
	gcc -c -O -Wall $<

clean:
	rm -f *~ sim.? sim.?? junk*
	rm -f ${OFILES}
	rm -f ${EXE}

# -Y to prevent search of system headers and
# pipe warning to /dev/null since it will complain
# about not finding the system headers!
depend:
	makedepend -Y ${UNIQSRC} &> /dev/null

# DO NOT DELETE

abc.o: fdtd3.h
ezincharm.o: ezinc3.h fdtd3.h
gridinitloss.o: fdtd3.h
lossy-half.o: fdtd3.h
snapshot.o: fdtd3.h
tfsf.o: fdtd3.h ezinc3.h
update3.o: fdtd3.h
